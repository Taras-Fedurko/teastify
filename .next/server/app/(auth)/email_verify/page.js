(()=>{var e={};e.id=531,e.ids=[531],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},1482:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>l,pages:()=>u,routeModule:()=>f,tree:()=>c});var s=t(70260),n=t(28203),a=t(25155),i=t.n(a),o=t(67292),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let c=["",{children:["(auth)",{children:["email_verify",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,92241)),"/Users/tarasfedurko/Projects/teastify/app/(auth)/email_verify/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,17509)),"/Users/tarasfedurko/Projects/teastify/app/(auth)/layout.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,43858)),"/Users/tarasfedurko/Projects/teastify/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,61129)),"/Users/tarasfedurko/Projects/teastify/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/tarasfedurko/Projects/teastify/app/(auth)/email_verify/page.tsx"],l={require:t,loadChunk:()=>Promise.resolve()},f=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(auth)/email_verify/page",pathname:"/email_verify",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},59833:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"40e47cfae2dac97585c81c001f0eb654fe8a6fe573":()=>o});var s=t(21590);t(70376);var n=t(40492),a=t(26371),i=t(63015);async function o(e){if(!e)return{message:"invaild token",success:!1};try{let r=await (0,a.JG)(e);if(!r)return{message:"invalid request or token may have been expired",success:!1};if(new Date(r.expires)<new Date)return{message:"token has been expired",success:!1};let t=await i.A.getUserByEmail(r.identifier);if(!t)return{message:"user not found, try to signup first",success:!1};return await n.A.user.update({where:{id:t.id},data:{emailVerified:new Date,email:r.identifier}}),{message:"Email Verified Sucessfully",success:!0}}catch(e){return console.log(e),{message:"something went wrong",success:!1}}}(0,t(99344).D)([o]),(0,s.A)(o,"40e47cfae2dac97585c81c001f0eb654fe8a6fe573",null)},75836:(e,r,t)=>{Promise.resolve().then(t.bind(t,22702))},85564:(e,r,t)=>{Promise.resolve().then(t.bind(t,74217))},42116:(e,r,t)=>{Promise.resolve().then(t.bind(t,2022))},95268:(e,r,t)=>{Promise.resolve().then(t.bind(t,57072))},87021:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var s=t(45512),n=t(58009),a=t(12705),i=t(21643),o=t(15960);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef(({className:e,variant:r,size:t,asChild:n=!1,...i},c)=>{let u=n?a.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(d({variant:r,size:t,className:e})),ref:c,...i})});c.displayName="Button"},28230:(e,r,t)=>{"use strict";t.d(r,{cn:()=>s.cn});var s=t(15960);t(40151)},74217:(e,r,t)=>{"use strict";t.d(r,{default:()=>i});var s=t(45512),n=t(88651);process.env.HOST,process.env.RECAPTCHA_SECRET;let a={sitekey:process.env.NEXT_PUBLIC_RECAPTCHA_SITE_KEY||"",secret:process.env.RECAPTCHA_SECRET,project_id:""};function i({children:e}){return(0,s.jsx)(n.G3,{reCaptchaKey:a.sitekey,children:e})}},57072:(e,r,t)=>{"use strict";t.d(r,{default:()=>l});var s=t(45512),n=t(87021),a=t(28531),i=t.n(a),o=t(58009),d=t(26248);let c=(0,d.createServerReference)("40e47cfae2dac97585c81c001f0eb654fe8a6fe573",d.callServer,void 0,d.findSourceMapURL,"emailVerifyAction");var u=t(28752);function l({token:e}){let[r,t]=(0,o.useState)();return(0,o.useCallback)(async()=>{let r=await c(e);t({type:r.success?"success":"error",message:r.message})},[e]),(0,s.jsxs)("div",{className:"",children:[!r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-12 h-12 border border-gray-600 rounded-full border-t-foreground animate-spin transition-all duration-800 border-r-foreground"}),(0,s.jsx)("p",{className:"mt-2 font-bold text-emerald-500 font-sans  animate-pulse",children:"Processing your email verification request"})]}),(0,s.jsx)(u.A,{...r}),r&&"success"===r.type&&(0,s.jsx)("p",{className:"text-gray-400 dark:text-gray-600",children:"you may close this page and signin to continue"}),(0,s.jsx)(i(),{href:"/auth/signin",children:(0,s.jsx)(n.$,{variant:"link",children:"Go Back to Signin"})})]})}},28752:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(45512),n=t(42933),a=t(28230);let i=function({message:e,type:r}){return e?(0,s.jsxs)("div",{className:(0,a.cn)("px-2 py-1 text-sm rounded-md flex items-center  gap-x-3 ","success"===r?"text-emerald-600":"text-destructive"),children:["success"===r?(0,s.jsx)(n.KaV,{}):(0,s.jsx)(n.Pip,{}),(0,s.jsx)("span",{children:e})]}):null}},92241:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(62740);t(76301);var n=t(2022);async function a({searchParams:e}){let r=(await e).token;return(0,s.jsx)(n.default,{token:r})}},17509:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(62740),n=t(22702);function a({children:e}){return(0,s.jsx)(n.default,{children:e})}},40492:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=new(t(96330)).PrismaClient},22702:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/tarasfedurko/Projects/teastify/modules/auth/components/CaptchaProvider.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/tarasfedurko/Projects/teastify/modules/auth/components/CaptchaProvider.tsx","default")},2022:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/tarasfedurko/Projects/teastify/modules/auth/components/EmailVerifyForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/tarasfedurko/Projects/teastify/modules/auth/components/EmailVerifyForm.tsx","default")},26371:(e,r,t)=>{"use strict";t.d(r,{Hu:()=>o,JG:()=>i}),t(92792),t(63015);var s=t(40492),n=t(462);async function a(e){try{return await s.A.verificationToken.findFirst({where:{identifier:e}})}catch(e){return console.log("Error in getVerificationToken",e),null}}async function i(e){try{return await s.A.verificationToken.findFirst({where:{token:e}})}catch(e){return console.log("Error in getVerificationToken",e),null}}async function o(e){try{let r=await a(e);return r&&await s.A.verificationToken.delete({where:{identifier_token:{identifier:r.identifier,token:r.token}}}),await s.A.verificationToken.create({data:{identifier:e,token:n.A(),expires:new Date(Date.now()+36e5)}})}catch(e){return console.log("Error in getVerificationToken",e),null}}},92792:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(40492),n=t(462);class a{async getResetPasswordToken(e){try{return await s.A.resetPasswordToken.findFirst({where:{email:e}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}async getResetPasswordTokenByToken(e){try{return await s.A.resetPasswordToken.findUnique({where:{token:e}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}async createResetPasswordToken(e){try{let r=await this.getResetPasswordToken(e);return r&&await s.A.resetPasswordToken.delete({where:{id:r.id}}),await s.A.resetPasswordToken.create({data:{email:e,token:n.A(),expires:new Date(Date.now()+36e5)}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}}let i=new a},63015:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(40492);class n{async getUserByEmail(e){try{return await s.A.user.findUnique({where:{email:e}})}catch(e){throw console.error("Error fetching user by email:",e),Error("Could not fetch user by email")}}async getUserById(e){try{return await s.A.user.findUnique({where:{id:e}})}catch(e){throw console.error("Error fetching user by ID:",e),Error("Could not fetch user by ID")}}async verifyUserEmail(e){await s.A.user.update({where:{id:e},data:{emailVerified:new Date}})}}let a=new n}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,199,468,318],()=>t(1482));module.exports=s})();