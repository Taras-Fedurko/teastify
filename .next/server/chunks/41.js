exports.id=41,exports.ids=[41],exports.modules={75836:(e,t,r)=>{Promise.resolve().then(r.bind(r,22702))},85564:(e,t,r)=>{Promise.resolve().then(r.bind(r,74217))},13163:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});var s=r(45512);r(58009);var a=r(28230);let n=({className:e})=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,a.cn)("animate-spin",e),children:(0,s.jsx)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})},87021:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var s=r(45512),a=r(58009),n=r(12705),i=r(21643),o=r(15960);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...i},d)=>{let c=a?n.DX:"button";return(0,s.jsx)(c,{className:(0,o.cn)(l({variant:t,size:r,className:e})),ref:d,...i})});d.displayName="Button"},61366:(e,t,r)=>{"use strict";r.d(t,{lV:()=>u,MJ:()=>y,zB:()=>p,eI:()=>h,lR:()=>w});var s=r(45512),a=r(58009),n=r(12705),i=r(6868),o=r(15960),l=r(92405);let d=(0,r(21643).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(l.b,{ref:r,className:(0,o.cn)(d(),e),...t}));c.displayName=l.b.displayName;let u=i.Op,m=a.createContext({}),p=({...e})=>(0,s.jsx)(m.Provider,{value:{name:e.name},children:(0,s.jsx)(i.xI,{...e})}),f=()=>{let e=a.useContext(m),t=a.useContext(g),{getFieldState:r,formState:s}=(0,i.xW)(),n=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...n}},g=a.createContext({}),h=a.forwardRef(({className:e,...t},r)=>{let n=a.useId();return(0,s.jsx)(g.Provider,{value:{id:n},children:(0,s.jsx)("div",{ref:r,className:(0,o.cn)("space-y-2",e),...t})})});h.displayName="FormItem";let w=a.forwardRef(({className:e,...t},r)=>{let{error:a,formItemId:n}=f();return(0,s.jsx)(c,{ref:r,className:(0,o.cn)(a&&"text-destructive",e),htmlFor:n,...t})});w.displayName="FormLabel";let y=a.forwardRef(({...e},t)=>{let{error:r,formItemId:a,formDescriptionId:i,formMessageId:o}=f();return(0,s.jsx)(n.DX,{ref:t,id:a,"aria-describedby":r?`${i} ${o}`:`${i}`,"aria-invalid":!!r,...e})});y.displayName="FormControl",a.forwardRef(({className:e,...t},r)=>{let{formDescriptionId:a}=f();return(0,s.jsx)("p",{ref:r,id:a,className:(0,o.cn)("text-[0.8rem] text-muted-foreground",e),...t})}).displayName="FormDescription",a.forwardRef(({className:e,children:t,...r},a)=>{let{error:n,formMessageId:i}=f(),l=n?String(n?.message):t;return l?(0,s.jsx)("p",{ref:a,id:i,className:(0,o.cn)("text-[0.8rem] font-medium text-destructive",e),...r,children:l}):null}).displayName="FormMessage"},25409:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(45512),a=r(58009),n=r(15960);let i=a.forwardRef(({className:e,type:t,...r},a)=>(0,s.jsx)("input",{type:t,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));i.displayName="Input"},28230:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s.cn});var s=r(15960);r(40151)},17035:(e,t,r)=>{"use strict";r.d(t,{Ih:()=>i,YQ:()=>d,Z2:()=>l,_3:()=>o,xY:()=>c});var s=r(16131);let a=s.Yj().email({message:"Please enter a valid email address"}),n=s.Yj().min(7,{message:"Password is required"}),i=s.Ik({email:a}),o=s.Ik({password:n,confirmPassword:n}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),l=s.Ik({email:a,password:s.Yj().min(1,{message:"Password is required"})}),d=s.Ik({name:s.Yj(),email:a,password:n}),c=s.Ik({email:a})},74217:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var s=r(45512),a=r(88651);process.env.HOST,process.env.RECAPTCHA_SECRET;let n={sitekey:process.env.NEXT_PUBLIC_RECAPTCHA_SITE_KEY||"",secret:process.env.RECAPTCHA_SECRET,project_id:""};function i({children:e}){return(0,s.jsx)(a.G3,{reCaptchaKey:n.sitekey,children:e})}},28752:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(45512),a=r(42933),n=r(28230);let i=function({message:e,type:t}){return e?(0,s.jsxs)("div",{className:(0,n.cn)("px-2 py-1 text-sm rounded-md flex items-center  gap-x-3 ","success"===t?"text-emerald-600":"text-destructive"),children:["success"===t?(0,s.jsx)(a.KaV,{}):(0,s.jsx)(a.Pip,{}),(0,s.jsx)("span",{children:e})]}):null}},40110:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var s=r(58009),a=r(6868),n=r(81914);let i=e=>{let{schema:t,defaultValues:r,captcha:i,onSubmitAction:o}=e,l={validating:!1,token:"",tokenTimestamp:Date.now()},d=(0,a.mN)({resolver:(0,n.u)(t),defaultValues:r}),[c,u]=(0,s.useState)(l),[m,p]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),[h,w]=(0,s.useTransition)(),y=async()=>{if(i?.enableCaptcha&&i.executeRecaptcha){u(e=>({...e,validating:!0}));try{let e=await i.executeRecaptcha(i.action||"default_action");if(!e)return p({message:"Error Getting Captcha",type:"error"}),null;return u({token:e,tokenTimestamp:Date.now(),validating:!1}),e}catch(e){console.error("Error refreshing CAPTCHA:",e),p({message:"Captcha verification failed",type:"error"}),u(e=>({...e,validating:!1}))}}return null},v=()=>{let e=Date.now(),t=!c.token||e-c.tokenTimestamp>(i?.tokenExpiryMs||12e4);return t&&u(l),t};return(0,s.useEffect)(()=>{i?.enableCaptcha&&v()&&y()},[c.token,i?.tokenExpiryMs,i?.enableCaptcha]),{form:d,message:m,redirect:f,isPending:h,onSubmit:d.handleSubmit((e=>{let t=e=>{e&&"success"in e&&(p({type:e.success?"success":"error",message:e?.message||""}),i?.enableCaptcha&&u(l))};return async r=>{p(null);let s=c.token;if(i?.enableCaptcha){if(!i.executeRecaptcha){p({message:"Captcha not available",type:"error"});return}if(v()&&(console.log("Token expired, refreshing CAPTCHA"),!(s=await y())))return}w(()=>{e(r,{token:s||"",tokenExpiryMs:i?.tokenExpiryMs||12e4,action:i?.action}).then(e=>{i?.enableCaptcha&&u(l),e?.redirect?g(e.redirect):t(e)}).catch(e=>{console.error("Submission Error:",e.stack),p({type:"error",message:"Submission failed. Please try again."})})})}})(o)),captchaState:c}}},17509:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(62740),a=r(22702);function n({children:e}){return(0,s.jsx)(a.default,{children:e})}},66630:(e,t,r)=>{"use strict";r.d(t,{Jv:()=>y,CI:()=>v});var s=r(73063),a=r(37067),n=r(75246),i=r(40492),o=r(8963),l=r(88218);async function d(e){let{identifier:t,url:r,provider:s,theme:a}=e,{host:n}=new URL(r),d=new o._().getTransport();await i.A.verificationToken.deleteMany({where:{identifier:t,token:{not:e.token}}});try{let e=await d.sendMail({to:t,from:s.from,subject:`Sign in to ${n}`,text:function({url:e,host:t}){return`Sign in to ${t}
${e}

If you did not request this email, you can safely ignore it.
This link is only valid for the next 24 hours.`}({url:r,host:n}),html:function(e){let{url:t,host:r,theme:s}=e,a=r.replace(/\./g,"&#8203;."),n=s.brandColor||"#4F46E5",i={background:"#f3f4f6",text:"#333333",mainBackground:"#ffffff",buttonBackground:n,buttonBorder:n,buttonText:s.buttonText||"#ffffff",footerText:"#9CA3AF"};return`
    <body style="background: ${i.background}; margin: 0; padding: 0; font-family: Arial, sans-serif;">
      <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: ${i.background}; padding: 40px 0;">
        <tr>
          <td align="center">
            <table width="100%" border="0" cellspacing="20" cellpadding="0" style="max-width: 600px; margin: auto; background: ${i.mainBackground}; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); overflow: hidden;">
              <tr>
                <td align="center" style="padding: 40px 0;">
                  <img src="${s?.logo||l.vo}" alt="${a}" style="height: 50px; margin-bottom: 24px;" />
                  <h1 style="font-size: 24px; color: ${i.text}; margin: 0;">Sign in to <strong>${a}</strong></h1>
                </td>
              </tr>
              <tr>
                <td align="center" style="padding: 0 40px 40px;">
                  <p style="font-size: 16px; color: ${i.text}; margin: 0 0 24px;">
                    Click the button below to sign in. This link is only valid for the next 24 hours.
                  </p>
                  <a href="${t}" target="_blank"
                    style="display: inline-block; padding: 14px 28px; font-size: 16px; color: ${i.buttonText}; background-color: ${i.buttonBackground}; border-radius: 6px; text-decoration: none; font-weight: bold; margin: 0 auto;">
                    Sign in
                  </a>
                </td>
              </tr>
              <tr>
                <td align="center" style="padding: 20px; font-size: 14px; color: ${i.footerText};">
                  If you did not request this email, you can safely ignore it.
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </body>
  `}({url:r,host:n,theme:a})}),i=e.rejected.concat(e.pending).filter(Boolean);if(i.length)throw Error(`Email(s) (${i.join(", ")}) could not be sent`)}catch(e){console.error("Error sending verification email:",e)}}var c=r(63015),u=r(73993),m=r(8805),p=r.n(m),f=r(61088),g=r(30672);let h={trustHost:!0,providers:[(0,u.A)({credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){let t=await g.Z2.parseAsync(e);if(!t)return null;let{email:r,password:s}=t,a=await c.A.getUserByEmail(r);return a&&a.password&&await p().compare(s,a.password)?a:null}}),(0,f.A)({clientSecret:process.env.GOOGLE_CLIENT_SECRET,clientId:process.env.GOOGLE_CLIENT_ID})]},{handlers:w,signIn:y,signOut:v,auth:x}=(0,s.Ay)({pages:{signIn:n.JZ.auth.signIn,verifyRequest:n.JZ.auth.verifyRequest,error:n.JZ.auth.authError,signOut:n.JZ.auth.signOut},events:{linkAccount:async({user:e})=>{e.id&&await c.A.verifyUserEmail(e.id)}},callbacks:{async signIn({user:e,account:t}){let r=t?.provider;if("credentials"!==r&&"http-email"!==r)return!0;if(!e||!e.id)return!1;let s=await c.A.getUserById(e.id);return!!s&&("credentials"!==r||!!s.emailVerified)||"http-email"===r&&n.JZ.auth.signUp},async jwt(e){let{token:t}=e;if(!t.sub)return t;let r=await c.A.getUserById(t.sub);return r&&(t.email=r.email,t.name=r.name,t.role=r.role),t},session:async({session:e,token:t})=>(e.user&&(t.role&&(e.user.role=t.role),t.sub&&(e.user.id=t.sub),t.email&&(e.user.email=t.email),t.name&&(e.user.name=t.name),t.picture&&(e.user.image=t.picture)),e)},adapter:(0,a.y)(i.A),session:{strategy:"jwt"},trustHost:h.trustHost,providers:[...h.providers,{id:"http-email",name:"Email",sendVerificationRequest:d,options:{},maxAge:3600,from:"onboarding@contentstream.com",type:"email"}]})},40492:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=new(r(96330)).PrismaClient},30672:(e,t,r)=>{"use strict";r.d(t,{Ih:()=>i,YQ:()=>d,Z2:()=>l,_3:()=>o});var s=r(16500);let a=s.Yj().email({message:"Please enter a valid email address"}),n=s.Yj().min(7,{message:"Password is required"}),i=s.Ik({email:a}),o=s.Ik({password:n,confirmPassword:n}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),l=s.Ik({email:a,password:s.Yj().min(1,{message:"Password is required"})}),d=s.Ik({name:s.Yj(),email:a,password:n});s.Ik({email:a})},22702:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/tarasfedurko/Projects/teastify/modules/auth/components/CaptchaProvider.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/tarasfedurko/Projects/teastify/modules/auth/components/CaptchaProvider.tsx","default")},88218:(e,t,r)=>{"use strict";r.d(t,{ZQ:()=>n,jg:()=>a,vo:()=>s});let s="https://img.freepik.com/free-psd/engraved-black-logo-mockup_125540-223.jpg?size=626&ext=jpg&ga=GA1.1.358797363.1725023893&semt=ais_hybrid",a=process.env.HOST||"http://localhost:3000";process.env.RECAPTCHA_SECRET;let n={sitekey:process.env.NEXT_PUBLIC_RECAPTCHA_SITE_KEY||"",secret:process.env.RECAPTCHA_SECRET,project_id:""}},92792:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(40492),a=r(462);class n{async getResetPasswordToken(e){try{return await s.A.resetPasswordToken.findFirst({where:{email:e}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}async getResetPasswordTokenByToken(e){try{return await s.A.resetPasswordToken.findUnique({where:{token:e}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}async createResetPasswordToken(e){try{let t=await this.getResetPasswordToken(e);return t&&await s.A.resetPasswordToken.delete({where:{id:t.id}}),await s.A.resetPasswordToken.create({data:{email:e,token:a.A(),expires:new Date(Date.now()+36e5)}})}catch(e){return console.log("Error in getResetPasswordToken",e),null}}}let i=new n},63015:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(40492);class a{async getUserByEmail(e){try{return await s.A.user.findUnique({where:{email:e}})}catch(e){throw console.error("Error fetching user by email:",e),Error("Could not fetch user by email")}}async getUserById(e){try{return await s.A.user.findUnique({where:{id:e}})}catch(e){throw console.error("Error fetching user by ID:",e),Error("Could not fetch user by ID")}}async verifyUserEmail(e){await s.A.user.update({where:{id:e},data:{emailVerified:new Date}})}}let n=new a},49604:(e,t,r)=>{"use strict";r.d(t,{gA:()=>i,ti:()=>l,ub:()=>o});var s=r(8963),a=r(8805),n=r.n(a);async function i(e,t){let r=`http://localhost:3000/auth/email_verify?token=${t}`,a=new s._;await a.sendVerificationEmail(e,r)}r(66630);let o=async e=>await n().hash(e,10);async function l(e,t){let r=new s._,a=`http://localhost:3000/auth/new-password?token=${t}`;await r.sendResetPasswordEmail(e,a)}},86850:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var s=r(21590);r(70376);var a=r(88218);async function n({token:e,action:t,tokenExpiryMs:r=12e4}){if("true"===process.env.DISABLE_CAPTCHA)return{success:!0,message:"Captcha is disabled."};if(!e)return console.error("Captcha token is missing."),{success:!1,message:"Captcha verification failed. Please try again."};let s=`https://www.google.com/recaptcha/api/siteverify?secret=${a.ZQ.secret}&response=${e}`;try{let e=await fetch(s,{method:"POST"}),r=await e.json();if(!r)return console.error("No response from CAPTCHA verification."),{success:!1,message:"Captcha validation failed. Please try again."};let{score:a,action:n}=r;if(a<.5||n!==t)return console.error("Captcha validation failed:",r),{success:!1,message:"Captcha validation failed. Please try again."};return{success:!0,message:"Captcha verified successfully."}}catch(e){return console.error("Error during CAPTCHA verification:",e),{success:!1,message:"CAPTCHA verification encountered an error."}}}(0,r(99344).D)([n]),(0,s.A)(n,"40a7f909b34bbc220b52554525321cedd4779d11bb",null)},8963:(e,t,r)=>{"use strict";r.d(t,{_:()=>c});var s=r(30342),a=r(79748),n=r(33873);class i{static{this.TEMPLATE_DIR=n.resolve(process.cwd(),"modules/auth/services/templates")}static async getTemplate(e,t){let r=n.join(i.TEMPLATE_DIR,e),s=await (0,a.readFile)(r,"utf-8");for(let[e,r]of Object.entries(t)){let t=RegExp(`{{${e}}}`,"g");s=s.replace(t,r)}return s}}let{GMAIL_SENDER_EMAIL:o,GMAIL_SENDER_PASSWORD:l}=process.env,d=new Date().getFullYear().toString();class c{constructor(){this.transporter=s.createTransport({service:"gmail",auth:{user:o,pass:l}})}getTransport(){return this.transporter}async sendResetPasswordEmail(e,t){let r=await i.getTemplate("reset-password.html",{verificationLink:t,year:d});return this.sendEmail(e,"Resetting Password",r)}async sendVerificationEmail(e,t){let r=await i.getTemplate("verification.html",{verificationLink:t,year:d});return this.sendEmail(e,"Email Verification",r,"emailverification@yourapp.com")}async sendEmail(e,t,r,s=o){return(await this.transporter.sendMail({from:s,to:e,subject:t,html:r})).accepted.length>0}}},75246:(e,t,r)=>{"use strict";r.d(t,{JZ:()=>s});let s={landing:"/",auth:{signIn:"/sign-in",signUp:"/sign-up",signOut:"/sign-out",forgorPassword:"/forgot-password",newPassword:"/new-password",emailVerify:"/email-verify",verifyRequest:"/verify-request",authError:"/auth-error"}};s.landing,s.auth.signIn,s.auth.signUp,s.auth.forgorPassword,s.auth.newPassword,s.auth.emailVerify,s.auth.verifyRequest,s.auth.authError,s.landing}};